use std::fmt;

pub struct Opcode {
    pub code: u8,
    pub operation_name: String,
}

impl fmt::Debug for Opcode {
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
        write!(f, "Opcode  {:2x}:{:4}", self.code, self.operation_name,)
    }
}

impl Opcode {
    pub fn new(val: u8) -> Opcode {
        Opcode {
            code: val,
            operation_name: opcode_name(val),
        }
    }
}

fn opcode_name(val: u8) -> String {
    String::from(match val {
        0x00 | 0x08 | 0x10 | 0x18 | 0x20 | 0x28 | 0x30 | 0x38 | 0xCB | 0xD9 | 0xDD | 0xED
        | 0xFD => "NOP",
        0x01 | 0x11 | 0x21 | 0x31 => "LXI",
        0x02 | 0x12 => "STAX",
        0x03 | 0x13 | 0x23 | 0x33 => "INX",
        0x04 | 0x0C | 0x14 | 0x1C | 0x24 | 0x2C | 0x34 | 0x3C => "INR",
        0x05 | 0x0D | 0x15 | 0x1D | 0x25 | 0x2D | 0x35 | 0x3D => "DCR",
        0x06 | 0x0E | 0x16 | 0x1E | 0x26 | 0x2E | 0x36 | 0x3E => "MVI",
        0x07 => "RLC",
        0x09 | 0x19 | 0x29 | 0x39 => "DAD",
        0x0A | 0x1A => "LDAX",
        0x0F => "RRC",
        0x17 => "RAL",
        0x1F => "RAR",
        0x22 => "SHLD",
        0x27 => "DAA",
        0x2A => "LHLD",
        0x2F => "CMA",
        0x32 => "STA",
        0x37 => "STC",
        0x3A => "LDA",
        0x3F => "CMC",
        0x40...0x7F => "MOV",
        0x80...0x87 => "ADD",
        0x88...0x8F => "ADC",
        0x90...0x97 => "SUB",
        0x98...0x9F => "SBB",
        0xA0...0xA7 => "ANA",
        0xA8...0xAF => "XRA",
        0xB0...0xB7 => "ORA",
        0xB8...0xBF => "CMP",
        0xC1 | 0xD1 | 0xE1 | 0xF1 => "POP",
        0xC2 => "JNZ",
        0xC3 => "JMP",
        0xC4 => "CNZ",
        0xC5 | 0xD5 | 0xE5 | 0xF5 => "PUSH",
        0xC6 => "ADI",
        0xC7 | 0xCF | 0xD7 | 0xDF | 0xE7 | 0xEF | 0xF7 | 0xFF => "RST",
        0xC8 => "RZ",
        0xC9 => "RET",
        0xCA => "JZ",
        0xCC => "CZ",
        0xCD => "CALL",
        0xCE => "ACI",
        0xD0 => "RNC",
        0xD2 => "JNC",
        0xD3 => "OUT",
        0xD4 => "CNC",
        0xD6 => "SUI",
        0xD8 => "RC",
        0xDA => "JC",
        0xDB => "IN",
        0xDC => "CC",
        0xE0 => "RPO",
        0xE2 => "JPO",
        0xE3 => "XTHL",
        0xE4 => "CPO",
        0xE6 => "ANI",
        0xE8 => "RPE",
        0xE9 => "PCHL",
        0xEA => "JPE",
        0xEB => "XCHG",
        0xEC => "CPE",
        0xEE => "XRI",
        0xF0 => "RP",
        0xF2 => "JP",
        0xF3 => "DI",
        0xF4 => "CP",
        0xF6 => "ORI",
        0xF8 => "RM",
        0xF9 => "SHPL",
        0xFA => "JM",
        0xFB => "EI",
        0xFC => "CM",
        0xFE => "CPI",
        _ => panic!("How is babby formed"),
    })
}
